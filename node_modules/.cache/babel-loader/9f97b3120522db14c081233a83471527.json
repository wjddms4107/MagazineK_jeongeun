{"ast":null,"code":"var _jsxFileName = \"/Users/nojeong-eun/Desktop/MagazineK_jeongeun/src/pages/Pay/Pay.js\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { useState, useEffect } from 'react';\nimport CashComponent from './CashComponent';\nimport ProductComponent from './ProductComponent';\nimport ProductEditor from './ProductEditor';\nimport './Pay.scss';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Pay = () => {\n  _s();\n\n  const [productDataList, setProductDataList] = useState([]);\n  const [userpoint, setUserpoint] = useState(0);\n  const token = localStorage.getItem('login-token') || '';\n  useEffect(() => {\n    fetch(`http://10.58.3.49:8000/orders/cart`, {\n      method: 'GET',\n      headers: {\n        AUTHORIZATION: token\n      }\n    }).then(res => res.json()).then(result => {\n      setUserpoint(result.result[0].user_point);\n      setProductDataList(result.result[0].product);\n    });\n  }, [productDataList.length]);\n\n  const patchOrderChange = (product_id, target) => {\n    fetch(`http://10.58.3.49:8000/orders/cart/${product_id}`, {\n      method: 'PATCH',\n      headers: {\n        AUTHORIZATION: token\n      },\n      body: JSON.stringify({\n        calculation: target\n      })\n    });\n  };\n\n  const onDelete = product_id => {\n    if (window.confirm('선택하신 상품을 삭제하시겠습니까?')) {\n      fetch(`http://10.58.3.49:8000/orders/cart/${product_id}`, {\n        method: 'DELETE',\n        headers: {\n          AUTHORIZATION: token\n        }\n      }).then(res => res.json()).then(res => {\n        if (res.message === 'SUCCESS') {\n          setProductDataList(productDataList => productDataList.filter(it => it.id !== product_id));\n          checkedItems.delete(product_id);\n          window.location.reload();\n        }\n      });\n    }\n  };\n\n  const [checkedItems, setCheckedItems] = useState(new Set());\n\n  const checkedItemHandler = (id, isChecked) => {\n    if (isChecked) {\n      checkedItems.add(id);\n      setCheckedItems(checkedItems);\n    } else if (!isChecked && checkedItems.has(id)) {\n      checkedItems.delete(id);\n      setCheckedItems(checkedItems);\n    }\n  };\n\n  const [isAllChecked, setIsAllChecked] = useState(false);\n\n  const allCheckedHandler = isChecked => {\n    if (!isAllChecked) {\n      setIsAllChecked(!isAllChecked);\n      setCheckedItems(new Set(productDataList.map(_ref => {\n        let {\n          id\n        } = _ref;\n        return id;\n      })));\n      setIsAllChecked(true);\n    } else {\n      setIsAllChecked(!isAllChecked);\n      checkedItems.clear();\n      setCheckedItems(checkedItems);\n      setIsAllChecked(false);\n    }\n  };\n\n  const onIncrease = id => {\n    const prevData = [...productDataList];\n    const changeIndex = prevData.findIndex(el => el.product_id === id);\n    prevData[changeIndex].quantity += 1;\n    setProductDataList(prevData);\n  };\n\n  const onDecrease = id => {\n    const prevData = [...productDataList];\n    const changeIndex = prevData.findIndex(el => el.product_id === id);\n\n    if (prevData[changeIndex].quantity !== 1) {\n      prevData[changeIndex].quantity -= 1;\n      setProductDataList(prevData);\n    }\n  };\n\n  const [totalPrice, setTotalPrice] = useState(0);\n  useEffect(() => {\n    let sum = 0;\n    productDataList.map(ProductData => {\n      return sum += ProductData.quantity * ProductData.price;\n    });\n    setTotalPrice(sum);\n  }, [productDataList]); // const overLapProps = {\n  //   isAllChecked: { isAllChecked },\n  //   onDelete: { onDelete },\n  //   checkedItems: { checkedItems },\n  // };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"payPageWrapper\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"payPageBox\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"choiceBox\",\n        children: [/*#__PURE__*/_jsxDEV(ProductEditor, {\n          allCheckedHandler: allCheckedHandler,\n          isAllChecked: isAllChecked,\n          onDelete: onDelete,\n          checkedItems: checkedItems // {...overLapProps}\n\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 11\n        }, this), productDataList.length > 0 && productDataList.map(ProductData => {\n          return /*#__PURE__*/_jsxDEV(ProductComponent, {\n            ProductData: ProductData,\n            id: ProductData.product_id,\n            checkedItemHandler: checkedItemHandler,\n            onIncrease: onIncrease,\n            onDecrease: onDecrease,\n            isAllChecked: isAllChecked,\n            onDelete: onDelete,\n            checkedItems: checkedItems,\n            patchOrderChange: patchOrderChange // {...overLapProps}\n\n          }, ProductData.product_id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 17\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CashComponent, {\n        totalPrice: totalPrice,\n        userpoint: userpoint,\n        token: token\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 120,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Pay, \"iQ0pGGkCC+x3MP8bjOfDx6u24/U=\");\n\n_c = Pay;\nexport default Pay;\n\nvar _c;\n\n$RefreshReg$(_c, \"Pay\");","map":{"version":3,"names":["React","useState","useEffect","CashComponent","ProductComponent","ProductEditor","Pay","productDataList","setProductDataList","userpoint","setUserpoint","token","localStorage","getItem","fetch","method","headers","AUTHORIZATION","then","res","json","result","user_point","product","length","patchOrderChange","product_id","target","body","JSON","stringify","calculation","onDelete","window","confirm","message","filter","it","id","checkedItems","delete","location","reload","setCheckedItems","Set","checkedItemHandler","isChecked","add","has","isAllChecked","setIsAllChecked","allCheckedHandler","map","clear","onIncrease","prevData","changeIndex","findIndex","el","quantity","onDecrease","totalPrice","setTotalPrice","sum","ProductData","price"],"sources":["/Users/nojeong-eun/Desktop/MagazineK_jeongeun/src/pages/Pay/Pay.js"],"sourcesContent":["import React from 'react';\nimport { useState, useEffect } from 'react';\nimport CashComponent from './CashComponent';\nimport ProductComponent from './ProductComponent';\nimport ProductEditor from './ProductEditor';\nimport './Pay.scss';\n\nconst Pay = () => {\n  const [productDataList, setProductDataList] = useState([]);\n  const [userpoint, setUserpoint] = useState(0);\n  const token = localStorage.getItem('login-token') || '';\n\n  useEffect(() => {\n    fetch(`http://10.58.3.49:8000/orders/cart`, {\n      method: 'GET',\n      headers: {\n        AUTHORIZATION: token,\n      },\n    })\n      .then(res => res.json())\n      .then(result => {\n        setUserpoint(result.result[0].user_point);\n        setProductDataList(result.result[0].product);\n      });\n  }, [productDataList.length]);\n\n  const patchOrderChange = (product_id, target) => {\n    fetch(`http://10.58.3.49:8000/orders/cart/${product_id}`, {\n      method: 'PATCH',\n      headers: {\n        AUTHORIZATION: token,\n      },\n      body: JSON.stringify({\n        calculation: target,\n      }),\n    });\n  };\n\n  const onDelete = product_id => {\n    if (window.confirm('선택하신 상품을 삭제하시겠습니까?')) {\n      fetch(`http://10.58.3.49:8000/orders/cart/${product_id}`, {\n        method: 'DELETE',\n        headers: {\n          AUTHORIZATION: token,\n        },\n      })\n        .then(res => res.json())\n        .then(res => {\n          if (res.message === 'SUCCESS') {\n            setProductDataList(productDataList =>\n              productDataList.filter(it => it.id !== product_id)\n            );\n            checkedItems.delete(product_id);\n            window.location.reload();\n          }\n        });\n    }\n  };\n\n  const [checkedItems, setCheckedItems] = useState(new Set());\n\n  const checkedItemHandler = (id, isChecked) => {\n    if (isChecked) {\n      checkedItems.add(id);\n      setCheckedItems(checkedItems);\n    } else if (!isChecked && checkedItems.has(id)) {\n      checkedItems.delete(id);\n      setCheckedItems(checkedItems);\n    }\n  };\n\n  const [isAllChecked, setIsAllChecked] = useState(false);\n\n  const allCheckedHandler = isChecked => {\n    if (!isAllChecked) {\n      setIsAllChecked(!isAllChecked);\n      setCheckedItems(new Set(productDataList.map(({ id }) => id)));\n      setIsAllChecked(true);\n    } else {\n      setIsAllChecked(!isAllChecked);\n      checkedItems.clear();\n      setCheckedItems(checkedItems);\n      setIsAllChecked(false);\n    }\n  };\n\n  const onIncrease = id => {\n    const prevData = [...productDataList];\n    const changeIndex = prevData.findIndex(el => el.product_id === id);\n    prevData[changeIndex].quantity += 1;\n    setProductDataList(prevData);\n  };\n\n  const onDecrease = id => {\n    const prevData = [...productDataList];\n    const changeIndex = prevData.findIndex(el => el.product_id === id);\n    if (prevData[changeIndex].quantity !== 1) {\n      prevData[changeIndex].quantity -= 1;\n      setProductDataList(prevData);\n    }\n  };\n\n  const [totalPrice, setTotalPrice] = useState(0);\n\n  useEffect(() => {\n    let sum = 0;\n    productDataList.map(ProductData => {\n      return (sum += ProductData.quantity * ProductData.price);\n    });\n    setTotalPrice(sum);\n  }, [productDataList]);\n\n  // const overLapProps = {\n  //   isAllChecked: { isAllChecked },\n  //   onDelete: { onDelete },\n  //   checkedItems: { checkedItems },\n  // };\n\n  return (\n    <div className=\"payPageWrapper\">\n      <div className=\"payPageBox\">\n        <div className=\"choiceBox\">\n          <ProductEditor\n            allCheckedHandler={allCheckedHandler}\n            isAllChecked={isAllChecked}\n            onDelete={onDelete}\n            checkedItems={checkedItems}\n            // {...overLapProps}\n          />\n          {productDataList.length > 0 &&\n            productDataList.map(ProductData => {\n              return (\n                <ProductComponent\n                  ProductData={ProductData}\n                  key={ProductData.product_id}\n                  id={ProductData.product_id}\n                  checkedItemHandler={checkedItemHandler}\n                  onIncrease={onIncrease}\n                  onDecrease={onDecrease}\n                  isAllChecked={isAllChecked}\n                  onDelete={onDelete}\n                  checkedItems={checkedItems}\n                  patchOrderChange={patchOrderChange}\n                  // {...overLapProps}\n                />\n              );\n            })}\n        </div>\n        <CashComponent\n          totalPrice={totalPrice}\n          userpoint={userpoint}\n          token={token}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default Pay;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}